\chapter{Introducción específica} % Main chapter title

\label{Chapter2}

%----------------------------------------------------------------------------------------
%	2.1 ENFOQUE DEL PROBLEMA
%----------------------------------------------------------------------------------------
ESCRIBIR PARRAFO INTRODUCTORIO

\section{Enfoque del problema}
\label{sec:Enfoque del problema}

El presente trabajo se estructura en torno a tres etapas principales, las cuales se 
encuentran ilustradas en la figura \ref{fig:Etapas de trabajo}.


\begin{figure}[ht]
	\centering
	\includegraphics[width=\textwidth]{./Figures/Etapas de trabajo.jpg}
	\caption{Representación esquemática de las etapas del trabajo.}\label{fig:Etapas de trabajo}
\end{figure}

Para comenzar, se llevó a cabo la adquisición de datos. 
Esta etapa fue realizada en colaboración con el servicio de cardiología del Hospital Alemán. 
Para ello, se recopiló información proveniente de presurometrías realizadas a pacientes 
hipertensos a partir del año 2013. Además, se efectuó un análisis exhaustivo de la historia 
clínica de cada paciente con el objetivo de identificar la ocurrencia de eventos cardiovasculares 
adversos mayores. De esta manera, se logró completar el \textit{dataset} con la variable a predecir (MACE) 
para cada paciente. Asimismo, se enriqueció el conjunto de datos con información clínica adicional 
con el fin de contar con variables explicativas más amplias para abordar el problema de investigación.

A continuación, se efectuó una etapa de preprocesamiento. En primer lugar, se procedió a realizar 
una limpieza de los datos con el propósito de seleccionar las variables más representativas del 
problema. Este proceso de selección permitió eliminar datos redundantes, ruidosos o de poca 
utilidad para el análisis posterior. También, se realizó un análisis exploratorio de datos 
para comprender de manera más profunda las características y patrones presentes en el \textit{dataset}. 
Esto proporcionó una visión más completa y significativa del conjunto de datos, permitiendo 
así una mejor comprensión de la naturaleza del problema y orientando la toma de decisiones 
posteriores en el desarrollo de este trabajo.

Por último, se procedió al diseñó y entrenamiento de dos modelos de clasificación utilizando 
redes neuronales. El primer modelo se construyó exclusivamente con los datos de presurometrías, 
mientras que el segundo modelo se enriqueció al incluir también los datos clínicos. El propósito 
de esta estrategia fue analizar y comparar el rendimiento de los dos modelos y evaluar si los 
datos de MAPA tienen un sustento suficiente para predecir la variable objetivo MACE. De esta 
manera, se buscó determinar si la inclusión de información clínica adicional contribuyó a 
mejorar las métricas de desempeño en la predicción de MACE, y si podría tener implicancias 
clínicas relevantes para el seguimiento de los pacientes.

%----------------------------------------------------------------------------------------
%	2.2 ALGORITMOS DE CLASIFICACION
%----------------------------------------------------------------------------------------
\section{Algoritmos de clasificación}
\label{sec:Algoritmos de clasificación}

ESCRIBIR PARRAFO INTRODUCTORIO

%----------------------------------------------------------------------------------------
% 2.2.1 Fundamentos de los modelos de clasificación

\subsection{Fundamentos de los modelos de clasificación}
Un algoritmo de aprendizaje automático es una herramienta que permite resolver tareas  
que suelen ser complejas de abordar para los seres humanos. La principal ventaja del \emph{machine 
learning} (ML) es su capacidad de aprender de los datos y extraer información relevante de 
estos. Las tareas de ML se describen en términos de cómo deben procesar un ejemplo, que se 
compone de una colección de características cuantitativas o \emph{features} que se miden de un objeto 
o evento que se desea procesar. En general, se representa un ejemplo como un vector $ x\in\mathbb{R}^n $,
donde cada entrada $x_{i}$ del vector corresponde a una característica del objeto 
o evento en cuestión. De esta manera, el algoritmo de aprendizaje de máquina es capaz de 
analizar los datos y extraer patrones que permiten tomar decisiones o realizar predicciones 
precisas \citep{CITE:35}.

En el campo del aprendizaje automático, los modelos de clasificación desempeñan un papel fundamental 
\citep{CITE:32}. Estos modelos se encargan de asignar etiquetas discretas o categorías a ejemplos 
específicos según sus características \citep{CITE:33}. Dependiendo del enfoque utilizado durante el 
entrenamiento, los modelos pueden ser de dos tipos: supervisados o no supervisados \citep{CITE:35}.

En un modelo de clasificación no supervisado, las etiquetas no se proporcionan en el conjunto de 
datos de entrenamiento \citep{CITE:34}. En lugar de ello, el algoritmo busca patrones y estructuras 
en los datos sin la guía explícita de las etiquetas. Como resultado, el objetivo es agrupar las instancias en 
clases basadas en similitudes \citep{CITE:33}.

Por otro lado, en un modelo de clasificación supervisado se proporciona al algoritmo un \emph{dataset} de 
entrenamiento que incluye tanto las características de las instancias como las etiquetas correspondientes 
\citep{CITE:33}. El modelo utiliza esta información para aprender a asociar las \emph{features} con las 
etiquetas, lo que le permite clasificar nuevas instancias de manera precisa. Algunos ejemplos de algoritmos 
supervisados ampliamente utilizados son los árboles de decisión, las máquinas de vectores de soporte y 
las redes neuronales \citep{CITE:34}. En este trabajo en particular, se empleó un modelo de clasificación 
supervisado basado en redes neuronales con el propósito de predecir MACE. Es importante señalar que se trata
de una clasificación binaria puesto que la variable \emph{target} tiene dos posibles valores: ausencia ("0") o 
presencia ("1") de eventos cardiovasculares adversos mayores.

%----------------------------------------------------------------------------------------
% 2.2.2 Estrategias para tratar el desbalance de clases
\subsection{Estrategias para tratar el desbalance de clases}

Un conjunto de datos se considera desbalanceado cuando presenta una proporción significativamente mayor 
de observaciones pertenecientes a una clase en comparación con la otra. Este desequilibrio puede tener 
un impacto considerable en el rendimiento de los modelos de aprendizaje automático. En el caso específico 
de una red neuronal entrenada con un \emph{dataset} desbalanceado, es probable que encuentre dificultades 
para discriminar de manera adecuada entre las diferentes clases. En otras palabras, el desequilibrio de 
clases crea un sesgo en el cual el modelo tiende a predecir la clase mayoritaria, lo que dificulta la 
correcta clasificación de los ejemplos pertenecientes a la clase minoritaria \citep{CITE:36} \citep{CITE:37}. 

Abordar el desequilibrio se convierte en un desafío crucial en la tarea de modelado y actualmente existen 
dos enfoques principales. El primero consiste en asignar diferentes pesos a los ejemplos de entrenamiento, 
mientras que el segundo implica realizar un remuestreo del conjunto de datos original. Es posible crear 
un nuevo muestreo del \emph{dataset} efectuando un sobremuestreo de la clase minoritaria y/o un submuestreo 
de la clase mayoritaria. El submuestreo implica una reducción del número de instancias de la clase mayoritaria, 
lo cual puede resultar en la pérdida de información valiosa que sea representativa de la distribución de los 
datos. Por otra parte, el sobremuestreo suele implicar réplicas de ejemplos de la clase minoritaria, lo cual 
puede generar un sobreajuste. En concreto, el modelo concede predicciones muy precisas para el conjunto de 
entrenamiento pero no logra generalizar adecuadamente cuando se presentan nuevos datos \citep{CITE:37}. 

Para mitigar las desventajas mencionadas anteriormente, Nitesh Chawla \emph{et al.} \citep{CITE:37} 
introducen una nueva técnica que implica una forma especial 
de sobremuestrear la clase minoritaria. El algoritmo 
\emph{Synthetic Minority Over-sampling Technique} (SMOTE) implica la creación de muestras sintéticas de 
la clase minoritaria. Se expone una representación gráfica del algoritmo en la figura \ref{fig:SMOTE}. 
En primer lugar, el método escoge un ejemplo de la clase minoritaria al azar y encuentra a sus $k$ vecinos 
más cercanos. Luego, se selecciona uno de los $k$ vecinos más cercanos y se crea una conexión mediante 
un segmento de línea en el espacio de características con la muestra elegida al azar. Finalmente, se crea 
una instancia sintética en un punto aleatorio entre los dos ejemplos. Este procedimiento se repite para
todas las muestras minoritarias \citep{CITE:38}. 

\begin{figure}[!htpb]
	\centering
	\subcaptionbox{SMOTE comienza con un conjunto de ejemplos positivos (puntos verdes) y negativos (puntos azules).}%
  	[0.3\linewidth]{\includegraphics[height=5cm]{./Figures/SMOTE_a.jpg}}\label{fig:SMOTEa}
	\hspace{1em}
	\subcaptionbox{Se selecciona un ejemplo positivo (punto con borde negro) y sus $k$ vecinos más cercanos entre los positivos (puntos amarillos, con $k = 3$).}
	[0.3\linewidth]{\includegraphics[height=5cm]{./Figures/SMOTE_b.jpg}}\label{fig:SMOTEb}
	\hspace{1em}
	\subcaptionbox{Para cada $k$ vecino más cercano se agrega un nuevo ejemplo sintético (puntos rojos) a lo largo de la línea recta que los conecta con el ejemplo positivo.}
	[0.3\linewidth]{\includegraphics[height=5cm]{./Figures/SMOTE_c.jpg}}
	\caption{Representación esquematica del algoritmo SMOTE\protect\footnotemark.}\label{fig:SMOTEc}
	   \label{fig:SMOTE}
\end{figure}

\footnotetext{Imagen adaptada de Schubach, Max; Re, Matteo; Robinson, Peter y Valentini, Giorgio. (2017). Imbalance-Aware Machine Learning for Predicting Rare and Common Disease-Associated Non-Coding Variants. Scientific Reports. 7. 10.1038/s41598-017-03011-5.}

En suma, SMOTE permite generar ejemplos sintéticos que sean relativamente cercanos en el espacio de 
características con respecto a las muestras existentes de la clase minoritaria. Además, las muestras 
pueden crearse en la cantidad que sea requerida. Por lo tanto, en escenarios donde el conjunto de 
datos no solo está desbalanceado sino que también presenta una escasez de muestras, la aplicación 
de SMOTE resulta particularmente efectiva \citep{CITE:37} \citep{CITE:38}.

%----------------------------------------------------------------------------------------
% 2.2.3 Métricas de evaluación en modelos de clasificación
\subsection{Evaluación de modelos de clasificación}
Para evaluar el desempeño de un modelo de clasificación binaria se suele emplear una matriz de confusión. 
Esta matriz se ilustra en la figura \ref{fig:MatrizConfusion}, donde las columnas representan la clase 
predicha y las filas corresponden a las clases reales. 
A partir de esta tabla, se definen cuatro indicadores:

\begin{itemize}
	\item Verdaderos positivos (TP, por sus siglas en inglés): asignaciones positivas correctas.
	\item Verdaderos negativos (TN, por sus siglas en inglés): asignaciones negativas correctas.
\item Falsos positivos (FP, por sus siglas en inglés): asignaciones positivas incorrectas. 
En otras palabras, indica la presencia de una condición cuando la misma no está presente en realidad.
\item Falsos negativos (FN, por sus siglas en inglés): asignaciones negativas incorrectas. 
En otras palabras, indica la ausencia de una condición cuando en realidad sí esta presente.
\end{itemize}

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.5\textwidth]{./Figures/MatrizConfusion.jpg}
	\caption{Matriz de confusión.}\label{fig:MatrizConfusion}
\end{figure}

En el ámbito médico, el falso negativo puede ocasionar las consecuencias más graves para la salud del 
paciente. En este trabajo en particular, implica el riesgo de no tomar las medidas necesarias para un 
tratamiento adecuado, lo cual puede incurrir en que el paciente experimente un evento cardiovascular 
adverso mayor. En consecuencia, es de gran importancia minimizar la tasa de falsos negativos al máximo, 
aún si esto implica un aumento de falsos positivos. Si bien este aumento puede implicar la necesidad de 
destinar más recursos médicos para realizar pruebas adicionales o tratamientos innecesarios, se garantiza 
que menos casos sean pasados por alto \citep{CITE:40}.

A partir de los valores de TP, TN, FP y FN se definen diferentes métricas para evaluar el desempeño de 
un modelo de clasificación. A continuación, se explican algunas en detalle.

\subsubsection{\emph{Precision}}
La presición o \emph{precision} es una métrica que permite conocer la proporción de ejemplos clasificados 
correctamente como positivos sobre el total de ejemplos clasificados como positivos. Una alta precisión 
indica que el modelo tiene una baja tasa de falsos positivos y clasifica correctamente la mayoría de las 
instancias positivas. La expresión matemática que describe este comportamiento es la siguiente:

\begin{equation}
	\label{eq:precision}
	Precision = \frac{TP}{TP + FP}
\end{equation}


\subsubsection{\emph{Recall}}
La sensibilidad, \emph{recall} o tasa positiva real (TPR) es una métrica que mide la proporción de ejemplos 
clasificados correctamente como positivos en relación con el total de ejemplos positivos. Por lo tanto, se 
mide la capacidad de identificar la mayoría de las muestras positivas presentes. La expresión matemática 
que describe este comportamiento es la siguiente:

\begin{equation}
	\label{eq:recall}
	Recall = \frac{TP}{TP + FN}
\end{equation}


\subsubsection{\emph{F1-Score}}
La métrica \emph{F1-Score} es la media armónica entre \emph{precision} y \emph{recall}. Dado que tiene 
en cuenta tanto a los FP cómo los FN, se emplea para evaluar un modelo cuando el conjunto de datos es 
desequilibrado. La expresión matemática que describe este comportamiento es la siguiente:

\begin{equation}
	\label{eq:f1score}
	F1\,score = \frac{2}{\nicefrac{1}{Precision} + \nicefrac{1}{Recall}} = 2\cdot\frac{Recall \cdot Precision}{Recall + Precision}
\end{equation}

\subsubsection{\emph{Accuracy}}
La exactitud o \emph{accuracy} es una métrica que mide la proporción de muestras clasificadas correctamente 
sobre el total de muestras evaluadas y se describe matemáticamente como:

\begin{equation}
	\label{eq:accuracy}
	Accuracy = \frac{TP + TN}{TP + TN + FP + FN}
\end{equation}

\subsubsection{\emph{Specificity}}
La especificidad, \emph{specificity} o tasa negativa real (TNR) se define como la proporción de falsos positivos 
sobre el total de negativos reales y es una métrica exactamente opuesta a la sensibilidad. Esta dada por:

\begin{equation}
	\label{eq:specificity}
	Specificity = \frac{TN}{TN + FP}
\end{equation}


\subsubsection{Curva ROC y AUC}
